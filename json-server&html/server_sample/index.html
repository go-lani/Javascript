<!doctype html>
<html lang="ko">
<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, user-scalable=yes, initial-scale=1.0">
	<meta name="description" content="사이트설명">
	<meta name="keywords" content="사이트검색키워드">
	<meta name="author" content="publee">
	<meta property="og:title" content="공유제목">
	<meta property="og:description" content="공유설명">
	<meta property="og:image" content="공유이미지 800x400">
	<title>Onello</title>
	<!-- <link rel="shortcut icon" type="image/x-icon" href=""> -->
</head>
<body>
	<script>
		const ajax = (()=>{
			const req = (method, url, payload) => {
    		return new Promise((resolve, reject) => {
					const xhr = new XMLHttpRequest();
					xhr.open(method, url);
					xhr.setRequestHeader('Content-type', 'application/json');
					xhr.send(JSON.stringify(payload));

					xhr.onreadystatechange = () => {
						if (xhr.readyState !== XMLHttpRequest.DONE) return;

						if (xhr.status === 200 || xhr.status === 201) {
							resolve(JSON.parse(xhr.response));
						} else {
							reject(new Error('Error', xhr.status));
						}
					};
				});
			};
			return {
				get(url) {
					return req('GET', url)
				},
				post(url, payload) {
					return req('POST', url, payload);
				},
			}
		})();

		const id = 2;

		// ajax.get(`http://localhost:5000/todos/${id}`)
		// 	// .then(todos => todos.filter(todo => todo.id !== id))
		// 	.then(console.log)

		// const getMaxId = () => {
		// 	let result = 0;
		// 	ajax.get('http://localhost:5000/todos')
		// 		.then(todos => Math.max(0, ...todos.map(todo => todo.id)) + 1)
		// 		.then(id => result = id)
		// 		.then(console.log);

		// 	console.log(result);
		// 	return result;
		// };

		// const _id = 4;

		// ajax.post('http://localhost:5000/todos', {
		// 	id: _id,
		// 	content: 'react',
		// 	completed: false
		// })
		// 	// .then(todos => todos.filter(todo => todo.id !== id))
		// 	.then(console.log);

		ajax.post('http://localhost:5000/todos', {
			id: 46,
			content: 'react',
			completed: false
		})
			// .then(todos => todos.filter(todo => todo.id !== id))
			.then(console.log);
	</script>
</body>
</html>